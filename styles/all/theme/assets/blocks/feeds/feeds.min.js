(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["blocks/feeds/feeds"],{

/***/ "./develop/components/Feeds/index.js":
/*!*******************************************!*\
  !*** ./develop/components/Feeds/index.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Feeds; });
/* harmony import */ var jquery_ui_ui_widgets_tabs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery-ui/ui/widgets/tabs */ "./node_modules/jquery-ui/ui/widgets/tabs.js");
/* harmony import */ var jquery_ui_ui_widgets_tabs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_tabs__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var jquery_ui_themes_base_core_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery-ui/themes/base/core.css */ "./node_modules/jquery-ui-themes/themes/smoothness/jquery-ui.css");
/* harmony import */ var jquery_ui_themes_base_core_css__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_core_css__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var jquery_ui_themes_base_theme_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jquery-ui/themes/base/theme.css */ "./node_modules/jquery-ui-themes/themes/smoothness/theme.css");
/* harmony import */ var jquery_ui_themes_base_theme_css__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_theme_css__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var jquery_ui_themes_base_tabs_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jquery-ui/themes/base/tabs.css */ "./node_modules/jquery-ui/themes/base/tabs.css");
/* harmony import */ var jquery_ui_themes_base_tabs_css__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_tabs_css__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var codemirror_mode_twig_twig__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! codemirror/mode/twig/twig */ "./node_modules/codemirror/mode/twig/twig.js");
/* harmony import */ var codemirror_mode_twig_twig__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(codemirror_mode_twig_twig__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var codemirror_addon_hint_show_hint__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! codemirror/addon/hint/show-hint */ "./node_modules/codemirror/addon/hint/show-hint.js");
/* harmony import */ var codemirror_addon_hint_show_hint__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(codemirror_addon_hint_show_hint__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var codemirror_addon_hint_show_hint_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! codemirror/addon/hint/show-hint.css */ "./node_modules/codemirror/addon/hint/show-hint.css");
/* harmony import */ var codemirror_addon_hint_show_hint_css__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(codemirror_addon_hint_show_hint_css__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _style_scss__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./style.scss */ "./develop/components/Feeds/style.scss");
/* harmony import */ var _style_scss__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_style_scss__WEBPACK_IMPORTED_MODULE_7__);
function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }









var _window = window,
    actions = _window.actions;
var samples = ["<a href=\"{{ item.link }}\" target=\"_blank\">{{ item.title }}</a>\t", "\n{% if item.enclosure.link %}\n<a href=\"{{ item.link }}\" target=\"_blank\" class=\"img-ui\">\n\t<img src=\"{{ item.enclosure.link }}\" alt=\"{{ lang('IMAGE') }}\" />\n</a>\n{% endif %}\n<div class=\"sm-fill-space small-img\">\n\t<p class=\"topic-title\"><a href=\"{{ item.link }}\" target=\"_blank\">{{ item.title }}</a></p>\n\t<div class=\"author\">{{ item.date|date(\"m/d/Y\") }}</div>\n\t<p>{{ item.description }}</p>\n\t<p>\n\t\t<a href=\"{{ item.feed.link }}\" target=\"_blank\">\n\t\t{% if item.feed.image_url %}\n\t\t\t<img src=\"{{ item.feed.image_url }}\" alt=\"{{ item.feed.image_title }}\" />\n\t\t{% else %}\n\t\t\t{{ item.feed.title }}\n\t\t{% endif %}\n\t\t</a>\n\t</p>\n</div>\n\t", "\n{% set images = attribute(item, 'get_item_tags', ['', 'image']) %}\n<a href=\"{{ item.link }}\" target=\"_blank\">\n\t<div class=\"img-ui\">\n\t\t<img src=\"{{ images[0].data }}\" alt=\"\" />\n\t</div>\n\t{{ item.title }}\n</a>\n\t"];
function Feeds($dialogDiv, Twig, _ref) {
  var CodeMirror = _ref.default,
      initCodeMirror = _ref.initCodeMirror;
  var fields = {};
  var tplData = {};
  var $previewBox;
  var $sourceBox;
  var $dataBox;
  var $template;
  Twig.extendFunction('lang', function (value) {
    return value;
  });

  function getFeeds() {
    return $('.sm-multi-input-item input').get().map(function (el) {
      return $(el).val();
    });
  }

  function previewFeed(tplString) {
    tplString = "<ul class=\"sm-list\">\n{% for item in items %}\n\t<li>\n\t\t".concat(tplString, "\n\t</li>\n{% endfor %}\n</ul>");
    var template = Twig.twig({
      data: tplString
    });
    var output = template.render(tplData);
    $previewBox.html(output);
    $sourceBox.text(output);
  }

  function getFields() {
    var data = {
      feeds: getFeeds(),
      method: 'get_fields',
      service: 'blitze.sitemaker.block.feeds'
    };
    $.post(actions.handle_custom_action, data).done(function (resp) {
      tplData = resp.data;
      fields = {
        children: resp.fields
      };
      previewFeed($template.val());
      $dataBox.html(JSON.stringify(tplData, undefined, 4));
    });
  }

  function getWordMapping(str) {
    var regex = /{%\s+for\s+(.*?)\s+in\s+(.*?)\s+%}/gim;
    var mapping = {
      item: 'items' // since user is only entering template for each item, for item in items

    };
    var m; // eslint-disable-next-line no-cond-assign

    while ((m = regex.exec(str)) !== null) {
      // This is necessary to avoid infinite loops with zero-width matches
      if (m.index === regex.lastIndex) {
        regex.lastIndex += 1;
      }

      var _m = m,
          _m2 = _slicedToArray(_m, 3),
          word = _m2[1],
          match = _m2[2];

      mapping[word] = match;
    }

    return mapping;
  }

  function translatePath(str, mapping) {
    var skipArray = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var parts = str.split('.');
    var parent = parts.shift();

    if (mapping[parent]) {
      var sub = translatePath(mapping[parent], mapping);
      var path = [sub].concat(_toConsumableArray(parts)).join('.');

      if (!skipArray) {
        path += '.0';
      }

      return path;
    }

    return [parent].concat(_toConsumableArray(parts)).join('.');
  }

  function findHint(cm) {
    var cursor = cm.getCursor();
    var line = cm.getLine(cursor.line);
    var contentFromLineUp = cm.getValue().split('\n').slice(0, cursor.line + 1).join();
    var start = cursor.ch;
    var end = cursor.ch;

    while (start && /\S/.test(line.charAt(start - 1))) {
      start -= 1;
    }

    while (end < line.length && /\w/.test(line.charAt(end))) {
      end += 1;
    }

    var word = line.slice(start, end).toLowerCase();
    var mapping = getWordMapping(contentFromLineUp);
    var translatedPath = translatePath(word, mapping, true);
    var wordPathAr = translatedPath.split('.');
    var currentWord = wordPathAr.pop();
    var found = wordPathAr.reduce(function (p, c) {
      return p.children && p.children[c] || null;
    }, fields);
    var list = Object.values(found && !Array.isArray(found) ? found.children : fields.children);

    if (list.length && currentWord.length) {
      list = list.filter(function (item) {
        return item.text.indexOf(currentWord) >= 0;
      });
    }

    return {
      list: list,
      from: CodeMirror.Pos(cursor.line, end - currentWord.length),
      to: CodeMirror.Pos(cursor.line, cursor.ch)
    };
  }

  function completeAfterDot(cm) {
    setTimeout(function () {
      var cursor = cm.getCursor();

      if (cm.getTokenTypeAt(cursor) === 'variable') {
        cm.showHint({
          hint: findHint,
          completeSingle: false
        });
      }
    }, 100);
    return CodeMirror.Pass;
  }

  function codeMirrorIsInitialized() {
    return $('#sm-feed-template').next().hasClass('CodeMirror');
  }

  $previewBox = $dialogDiv.find('#sm-feeds-preview');
  $sourceBox = $dialogDiv.find('#sm-feeds-preview-source');
  $dataBox = $dialogDiv.find('#sm-feeds-data');
  $template = $dialogDiv.find('#sm-feed-template');

  if (!codeMirrorIsInitialized()) {
    var codeMirror = initCodeMirror('#sm-feed-template', {
      mode: {
        name: 'twig',
        htmlMode: true
      },
      actionBtnsSelector: '.sm-feed-template-button',
      extraKeys: {
        "'.'": completeAfterDot,
        'Ctrl-Space': 'autocomplete'
      }
    });
    codeMirror.on('blur', function (cm) {
      var data = cm.getValue().trim();
      previewFeed(data);
    });
    var sampleKey = 0;
    $dialogDiv.on('click', '#sm-template-samples', function (e) {
      e.preventDefault();
      var sample = samples[sampleKey].trim();
      sampleKey = sampleKey < samples.length - 1 ? sampleKey + 1 : 0;
      codeMirror.setValue(sample);
      previewFeed(sample);
    });
  }

  $dialogDiv.on('input', '.sm-multi-input-item input', getFields);
  $dialogDiv.on('click', '.sm-multi-input-delete', getFields);
  $dialogDiv.find('#sm-feeds-tabs').tabs({
    active: false,
    collapsible: true
  });
  getFields();
}
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! jquery */ "jquery")))

/***/ }),

/***/ "./develop/components/Feeds/style.scss":
/*!*********************************************!*\
  !*** ./develop/components/Feeds/style.scss ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9kZXZlbG9wL2NvbXBvbmVudHMvRmVlZHMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vZGV2ZWxvcC9jb21wb25lbnRzL0ZlZWRzL3N0eWxlLnNjc3MiXSwibmFtZXMiOlsid2luZG93IiwiYWN0aW9ucyIsInNhbXBsZXMiLCJGZWVkcyIsIiRkaWFsb2dEaXYiLCJUd2lnIiwiQ29kZU1pcnJvciIsImRlZmF1bHQiLCJpbml0Q29kZU1pcnJvciIsImZpZWxkcyIsInRwbERhdGEiLCIkcHJldmlld0JveCIsIiRzb3VyY2VCb3giLCIkZGF0YUJveCIsIiR0ZW1wbGF0ZSIsImV4dGVuZEZ1bmN0aW9uIiwidmFsdWUiLCJnZXRGZWVkcyIsIiQiLCJnZXQiLCJtYXAiLCJlbCIsInZhbCIsInByZXZpZXdGZWVkIiwidHBsU3RyaW5nIiwidGVtcGxhdGUiLCJ0d2lnIiwiZGF0YSIsIm91dHB1dCIsInJlbmRlciIsImh0bWwiLCJ0ZXh0IiwiZ2V0RmllbGRzIiwiZmVlZHMiLCJtZXRob2QiLCJzZXJ2aWNlIiwicG9zdCIsImhhbmRsZV9jdXN0b21fYWN0aW9uIiwiZG9uZSIsInJlc3AiLCJjaGlsZHJlbiIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1bmRlZmluZWQiLCJnZXRXb3JkTWFwcGluZyIsInN0ciIsInJlZ2V4IiwibWFwcGluZyIsIml0ZW0iLCJtIiwiZXhlYyIsImluZGV4IiwibGFzdEluZGV4Iiwid29yZCIsIm1hdGNoIiwidHJhbnNsYXRlUGF0aCIsInNraXBBcnJheSIsInBhcnRzIiwic3BsaXQiLCJwYXJlbnQiLCJzaGlmdCIsInN1YiIsInBhdGgiLCJqb2luIiwiZmluZEhpbnQiLCJjbSIsImN1cnNvciIsImdldEN1cnNvciIsImxpbmUiLCJnZXRMaW5lIiwiY29udGVudEZyb21MaW5lVXAiLCJnZXRWYWx1ZSIsInNsaWNlIiwic3RhcnQiLCJjaCIsImVuZCIsInRlc3QiLCJjaGFyQXQiLCJsZW5ndGgiLCJ0b0xvd2VyQ2FzZSIsInRyYW5zbGF0ZWRQYXRoIiwid29yZFBhdGhBciIsImN1cnJlbnRXb3JkIiwicG9wIiwiZm91bmQiLCJyZWR1Y2UiLCJwIiwiYyIsImxpc3QiLCJPYmplY3QiLCJ2YWx1ZXMiLCJBcnJheSIsImlzQXJyYXkiLCJmaWx0ZXIiLCJpbmRleE9mIiwiZnJvbSIsIlBvcyIsInRvIiwiY29tcGxldGVBZnRlckRvdCIsInNldFRpbWVvdXQiLCJnZXRUb2tlblR5cGVBdCIsInNob3dIaW50IiwiaGludCIsImNvbXBsZXRlU2luZ2xlIiwiUGFzcyIsImNvZGVNaXJyb3JJc0luaXRpYWxpemVkIiwibmV4dCIsImhhc0NsYXNzIiwiZmluZCIsImNvZGVNaXJyb3IiLCJtb2RlIiwibmFtZSIsImh0bWxNb2RlIiwiYWN0aW9uQnRuc1NlbGVjdG9yIiwiZXh0cmFLZXlzIiwib24iLCJ0cmltIiwic2FtcGxlS2V5IiwiZSIsInByZXZlbnREZWZhdWx0Iiwic2FtcGxlIiwic2V0VmFsdWUiLCJ0YWJzIiwiYWN0aXZlIiwiY29sbGFwc2libGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7Y0FFb0JBLE07SUFBWkMsTyxXQUFBQSxPO0FBRVIsSUFBTUMsT0FBTyxHQUFHLG0vQkFBaEI7QUFrQ2UsU0FBU0MsS0FBVCxDQUNkQyxVQURjLEVBRWRDLElBRmMsUUFJYjtBQUFBLE1BRFVDLFVBQ1YsUUFEQ0MsT0FDRDtBQUFBLE1BRHNCQyxjQUN0QixRQURzQkEsY0FDdEI7QUFDRCxNQUFJQyxNQUFNLEdBQUcsRUFBYjtBQUNBLE1BQUlDLE9BQU8sR0FBRyxFQUFkO0FBQ0EsTUFBSUMsV0FBSjtBQUNBLE1BQUlDLFVBQUo7QUFDQSxNQUFJQyxRQUFKO0FBQ0EsTUFBSUMsU0FBSjtBQUVBVCxNQUFJLENBQUNVLGNBQUwsQ0FBb0IsTUFBcEIsRUFBNEIsVUFBQUMsS0FBSztBQUFBLFdBQUlBLEtBQUo7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QUFFLENBQUNNLFFBQUgsR0FBYzZDLElBQWQsRUFBYjtBQUNBN0YsaUJBQVcsQ0FBQ0ksSUFBRCxDQUFYO0FBQ0EsS0FIRDtBQUtBLFFBQUkwRixTQUFTLEdBQUcsQ0FBaEI7QUFDQWpILGNBQVUsQ0FBQytHLEVBQVgsQ0FBYyxPQUFkLEVBQXVCLHNCQUF2QixFQUErQyxVQUFBRyxDQUFDLEVBQUk7QUFDbkRBLE9BQUMsQ0FBQ0MsY0FBRjtBQUNBLFVBQU1DLE1BQU0sR0FBR3RILE9BQU8sQ0FBQ21ILFNBQUQsQ0FBUCxDQUFtQkQsSUFBbkIsRUFBZjtBQUNBQyxlQUFTLEdBQUdBLFNBQVMsR0FBR25ILE9BQU8sQ0FBQzRFLE1BQVIsR0FBaUIsQ0FBN0IsR0FBaUN1QyxTQUFTLEdBQUcsQ0FBN0MsR0FBaUQsQ0FBN0Q7QUFDQVIsZ0JBQVUsQ0FBQ1ksUUFBWCxDQUFvQkQsTUFBcEI7QUFDQWpHLGlCQUFXLENBQUNpRyxNQUFELENBQVg7QUFDQSxLQU5EO0FBT0E7O0FBRURwSCxZQUFVLENBQUMrRyxFQUFYLENBQWMsT0FBZCxFQUF1Qiw0QkFBdkIsRUFBcURuRixTQUFyRDtBQUNBNUIsWUFBVSxDQUFDK0csRUFBWCxDQUFjLE9BQWQsRUFBdUIsd0JBQXZCLEVBQWlEbkYsU0FBakQ7QUFDQTVCLFlBQVUsQ0FBQ3dHLElBQVgsQ0FBZ0IsZ0JBQWhCLEVBQWtDYyxJQUFsQyxDQUF1QztBQUN0Q0MsVUFBTSxFQUFFLEtBRDhCO0FBRXRDQyxlQUFXLEVBQUU7QUFGeUIsR0FBdkM7QUFLQTVGLFdBQVM7QUFDVCxDOzs7Ozs7Ozs7Ozs7QUM5T0QsdUMiLCJmaWxlIjoiYmxvY2tzL2ZlZWRzL2ZlZWRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnanF1ZXJ5LXVpL3VpL3dpZGdldHMvdGFicyc7XG5pbXBvcnQgJ2pxdWVyeS11aS90aGVtZXMvYmFzZS9jb3JlLmNzcyc7XG5pbXBvcnQgJ2pxdWVyeS11aS90aGVtZXMvYmFzZS90aGVtZS5jc3MnO1xuaW1wb3J0ICdqcXVlcnktdWkvdGhlbWVzL2Jhc2UvdGFicy5jc3MnO1xuXG5pbXBvcnQgJ2NvZGVtaXJyb3IvbW9kZS90d2lnL3R3aWcnO1xuaW1wb3J0ICdjb2RlbWlycm9yL2FkZG9uL2hpbnQvc2hvdy1oaW50JztcbmltcG9ydCAnY29kZW1pcnJvci9hZGRvbi9oaW50L3Nob3ctaGludC5jc3MnO1xuXG5pbXBvcnQgJy4vc3R5bGUuc2Nzcyc7XG5cbmNvbnN0IHsgYWN0aW9ucyB9ID0gd2luZG93O1xuXG5jb25zdCBzYW1wbGVzID0gW1xuXHRgPGEgaHJlZj1cInt7IGl0ZW0ubGluayB9fVwiIHRhcmdldD1cIl9ibGFua1wiPnt7IGl0ZW0udGl0bGUgfX08L2E+XHRgLFxuXHRgXG57JSBpZiBpdGVtLmVuY2xvc3VyZS5saW5rICV9XG48YSBocmVmPVwie3sgaXRlbS5saW5rIH19XCIgdGFyZ2V0PVwiX2JsYW5rXCIgY2xhc3M9XCJpbWctdWlcIj5cblx0PGltZyBzcmM9XCJ7eyBpdGVtLmVuY2xvc3VyZS5saW5rIH19XCIgYWx0PVwie3sgbGFuZygnSU1BR0UnKSB9fVwiIC8+XG48L2E+XG57JSBlbmRpZiAlfVxuPGRpdiBjbGFzcz1cInNtLWZpbGwtc3BhY2Ugc21hbGwtaW1nXCI+XG5cdDxwIGNsYXNzPVwidG9waWMtdGl0bGVcIj48YSBocmVmPVwie3sgaXRlbS5saW5rIH19XCIgdGFyZ2V0PVwiX2JsYW5rXCI+e3sgaXRlbS50aXRsZSB9fTwvYT48L3A+XG5cdDxkaXYgY2xhc3M9XCJhdXRob3JcIj57eyBpdGVtLmRhdGV8ZGF0ZShcIm0vZC9ZXCIpIH19PC9kaXY+XG5cdDxwPnt7IGl0ZW0uZGVzY3JpcHRpb24gfX08L3A+XG5cdDxwPlxuXHRcdDxhIGhyZWY9XCJ7eyBpdGVtLmZlZWQubGluayB9fVwiIHRhcmdldD1cIl9ibGFua1wiPlxuXHRcdHslIGlmIGl0ZW0uZmVlZC5pbWFnZV91cmwgJX1cblx0XHRcdDxpbWcgc3JjPVwie3sgaXRlbS5mZWVkLmltYWdlX3VybCB9fVwiIGFsdD1cInt7IGl0ZW0uZmVlZC5pbWFnZV90aXRsZSB9fVwiIC8+XG5cdFx0eyUgZWxzZSAlfVxuXHRcdFx0e3sgaXRlbS5mZWVkLnRpdGxlIH19XG5cdFx0eyUgZW5kaWYgJX1cblx0XHQ8L2E+XG5cdDwvcD5cbjwvZGl2PlxuXHRgLFxuXHRgXG57JSBzZXQgaW1hZ2VzID0gYXR0cmlidXRlKGl0ZW0sICdnZXRfaXRlbV90YWdzJywgWycnLCAnaW1hZ2UnXSkgJX1cbjxhIGhyZWY9XCJ7eyBpdGVtLmxpbmsgfX1cIiB0YXJnZXQ9XCJfYmxhbmtcIj5cblx0PGRpdiBjbGFzcz1cImltZy11aVwiPlxuXHRcdDxpbWcgc3JjPVwie3sgaW1hZ2VzWzBdLmRhdGEgfX1cIiBhbHQ9XCJcIiAvPlxuXHQ8L2Rpdj5cblx0e3sgaXRlbS50aXRsZSB9fVxuPC9hPlxuXHRgLFxuXTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gRmVlZHMoXG5cdCRkaWFsb2dEaXYsXG5cdFR3aWcsXG5cdHsgZGVmYXVsdDogQ29kZU1pcnJvciwgaW5pdENvZGVNaXJyb3IgfSxcbikge1xuXHRsZXQgZmllbGRzID0ge307XG5cdGxldCB0cGxEYXRhID0ge307XG5cdGxldCAkcHJldmlld0JveDtcblx0bGV0ICRzb3VyY2VCb3g7XG5cdGxldCAkZGF0YUJveDtcblx0bGV0ICR0ZW1wbGF0ZTtcblxuXHRUd2lnLmV4dGVuZEZ1bmN0aW9uKCdsYW5nJywgdmFsdWUgPT4gdmFsdWUpO1xuXG5cdGZ1bmN0aW9uIGdldEZlZWRzKCkge1xuXHRcdHJldHVybiAkKCcuc20tbXVsdGktaW5wdXQtaXRlbSBpbnB1dCcpXG5cdFx0XHQuZ2V0KClcblx0XHRcdC5tYXAoZWwgPT4gJChlbCkudmFsKCkpO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJldmlld0ZlZWQodHBsU3RyaW5nKSB7XG5cdFx0dHBsU3RyaW5nID0gYDx1bCBjbGFzcz1cInNtLWxpc3RcIj5cbnslIGZvciBpdGVtIGluIGl0ZW1zICV9XG5cdDxsaT5cblx0XHQke3RwbFN0cmluZ31cblx0PC9saT5cbnslIGVuZGZvciAlfVxuPC91bD5gO1xuXHRcdGNvbnN0IHRlbXBsYXRlID0gVHdpZy50d2lnKHsgZGF0YTogdHBsU3RyaW5nIH0pO1xuXHRcdGNvbnN0IG91dHB1dCA9IHRlbXBsYXRlLnJlbmRlcih0cGxEYXRhKTtcblxuXHRcdCRwcmV2aWV3Qm94Lmh0bWwob3V0cHV0KTtcblx0XHQkc291cmNlQm94LnRleHQob3V0cHV0KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGdldEZpZWxkcygpIHtcblx0XHRjb25zdCBkYXRhID0ge1xuXHRcdFx0ZmVlZHM6IGdldEZlZWRzKCksXG5cdFx0XHRtZXRob2Q6ICdnZXRfZmllbGRzJyxcblx0XHRcdHNlcnZpY2U6ICdibGl0emUuc2l0ZW1ha2VyLmJsb2NrLmZlZWRzJyxcblx0XHR9O1xuXG5cdFx0JC5wb3N0KGFjdGlvbnMuaGFuZGxlX2N1c3RvbV9hY3Rpb24sIGRhdGEpLmRvbmUocmVzcCA9PiB7XG5cdFx0XHR0cGxEYXRhID0gcmVzcC5kYXRhO1xuXHRcdFx0ZmllbGRzID0ge1xuXHRcdFx0XHRjaGlsZHJlbjogcmVzcC5maWVsZHMsXG5cdFx0XHR9O1xuXG5cdFx0XHRwcmV2aWV3RmVlZCgkdGVtcGxhdGUudmFsKCkpO1xuXHRcdFx0JGRhdGFCb3guaHRtbChKU09OLnN0cmluZ2lmeSh0cGxEYXRhLCB1bmRlZmluZWQsIDQpKTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGdldFdvcmRNYXBwaW5nKHN0cikge1xuXHRcdGNvbnN0IHJlZ2V4ID0gL3slXFxzK2ZvclxccysoLio/KVxccytpblxccysoLio/KVxccyslfS9naW07XG5cdFx0Y29uc3QgbWFwcGluZyA9IHtcblx0XHRcdGl0ZW06ICdpdGVtcycsIC8vIHNpbmNlIHVzZXIgaXMgb25seSBlbnRlcmluZyB0ZW1wbGF0ZSBmb3IgZWFjaCBpdGVtLCBmb3IgaXRlbSBpbiBpdGVtc1xuXHRcdH07XG5cblx0XHRsZXQgbTtcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uZC1hc3NpZ25cblx0XHR3aGlsZSAoKG0gPSByZWdleC5leGVjKHN0cikpICE9PSBudWxsKSB7XG5cdFx0XHQvLyBUaGlzIGlzIG5lY2Vzc2FyeSB0byBhdm9pZCBpbmZpbml0ZSBsb29wcyB3aXRoIHplcm8td2lkdGggbWF0Y2hlc1xuXHRcdFx0aWYgKG0uaW5kZXggPT09IHJlZ2V4Lmxhc3RJbmRleCkge1xuXHRcdFx0XHRyZWdleC5sYXN0SW5kZXggKz0gMTtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgWywgd29yZCwgbWF0Y2hdID0gbTtcblx0XHRcdG1hcHBpbmdbd29yZF0gPSBtYXRjaDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbWFwcGluZztcblx0fVxuXG5cdGZ1bmN0aW9uIHRyYW5zbGF0ZVBhdGgoc3RyLCBtYXBwaW5nLCBza2lwQXJyYXkgPSBmYWxzZSkge1xuXHRcdGNvbnN0IHBhcnRzID0gc3RyLnNwbGl0KCcuJyk7XG5cdFx0Y29uc3QgcGFyZW50ID0gcGFydHMuc2hpZnQoKTtcblx0XHRpZiAobWFwcGluZ1twYXJlbnRdKSB7XG5cdFx0XHRjb25zdCBzdWIgPSB0cmFuc2xhdGVQYXRoKG1hcHBpbmdbcGFyZW50XSwgbWFwcGluZyk7XG5cdFx0XHRsZXQgcGF0aCA9IFtzdWIsIC4uLnBhcnRzXS5qb2luKCcuJyk7XG5cdFx0XHRpZiAoIXNraXBBcnJheSkge1xuXHRcdFx0XHRwYXRoICs9ICcuMCc7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gcGF0aDtcblx0XHR9XG5cdFx0cmV0dXJuIFtwYXJlbnQsIC4uLnBhcnRzXS5qb2luKCcuJyk7XG5cdH1cblxuXHRmdW5jdGlvbiBmaW5kSGludChjbSkge1xuXHRcdGNvbnN0IGN1cnNvciA9IGNtLmdldEN1cnNvcigpO1xuXHRcdGNvbnN0IGxpbmUgPSBjbS5nZXRMaW5lKGN1cnNvci5saW5lKTtcblx0XHRjb25zdCBjb250ZW50RnJvbUxpbmVVcCA9IGNtXG5cdFx0XHQuZ2V0VmFsdWUoKVxuXHRcdFx0LnNwbGl0KCdcXG4nKVxuXHRcdFx0LnNsaWNlKDAsIGN1cnNvci5saW5lICsgMSlcblx0XHRcdC5qb2luKCk7XG5cdFx0bGV0IHN0YXJ0ID0gY3Vyc29yLmNoO1xuXHRcdGxldCBlbmQgPSBjdXJzb3IuY2g7XG5cblx0XHR3aGlsZSAoc3RhcnQgJiYgL1xcUy8udGVzdChsaW5lLmNoYXJBdChzdGFydCAtIDEpKSkge1xuXHRcdFx0c3RhcnQgLT0gMTtcblx0XHR9XG5cblx0XHR3aGlsZSAoZW5kIDwgbGluZS5sZW5ndGggJiYgL1xcdy8udGVzdChsaW5lLmNoYXJBdChlbmQpKSkge1xuXHRcdFx0ZW5kICs9IDE7XG5cdFx0fVxuXG5cdFx0Y29uc3Qgd29yZCA9IGxpbmUuc2xpY2Uoc3RhcnQsIGVuZCkudG9Mb3dlckNhc2UoKTtcblx0XHRjb25zdCBtYXBwaW5nID0gZ2V0V29yZE1hcHBpbmcoY29udGVudEZyb21MaW5lVXApO1xuXHRcdGNvbnN0IHRyYW5zbGF0ZWRQYXRoID0gdHJhbnNsYXRlUGF0aCh3b3JkLCBtYXBwaW5nLCB0cnVlKTtcblx0XHRjb25zdCB3b3JkUGF0aEFyID0gdHJhbnNsYXRlZFBhdGguc3BsaXQoJy4nKTtcblx0XHRjb25zdCBjdXJyZW50V29yZCA9IHdvcmRQYXRoQXIucG9wKCk7XG5cblx0XHRjb25zdCBmb3VuZCA9IHdvcmRQYXRoQXIucmVkdWNlKFxuXHRcdFx0KHAsIGMpID0+IChwLmNoaWxkcmVuICYmIHAuY2hpbGRyZW5bY10pIHx8IG51bGwsXG5cdFx0XHRmaWVsZHMsXG5cdFx0KTtcblxuXHRcdGxldCBsaXN0ID0gT2JqZWN0LnZhbHVlcyhcblx0XHRcdGZvdW5kICYmICFBcnJheS5pc0FycmF5KGZvdW5kKSA/IGZvdW5kLmNoaWxkcmVuIDogZmllbGRzLmNoaWxkcmVuLFxuXHRcdCk7XG5cblx0XHRpZiAobGlzdC5sZW5ndGggJiYgY3VycmVudFdvcmQubGVuZ3RoKSB7XG5cdFx0XHRsaXN0ID0gbGlzdC5maWx0ZXIoaXRlbSA9PiBpdGVtLnRleHQuaW5kZXhPZihjdXJyZW50V29yZCkgPj0gMCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGxpc3QsXG5cdFx0XHRmcm9tOiBDb2RlTWlycm9yLlBvcyhjdXJzb3IubGluZSwgZW5kIC0gY3VycmVudFdvcmQubGVuZ3RoKSxcblx0XHRcdHRvOiBDb2RlTWlycm9yLlBvcyhjdXJzb3IubGluZSwgY3Vyc29yLmNoKSxcblx0XHR9O1xuXHR9XG5cblx0ZnVuY3Rpb24gY29tcGxldGVBZnRlckRvdChjbSkge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Y29uc3QgY3Vyc29yID0gY20uZ2V0Q3Vyc29yKCk7XG5cblx0XHRcdGlmIChjbS5nZXRUb2tlblR5cGVBdChjdXJzb3IpID09PSAndmFyaWFibGUnKSB7XG5cdFx0XHRcdGNtLnNob3dIaW50KHtcblx0XHRcdFx0XHRoaW50OiBmaW5kSGludCxcblx0XHRcdFx0XHRjb21wbGV0ZVNpbmdsZTogZmFsc2UsXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0sIDEwMCk7XG5cdFx0cmV0dXJuIENvZGVNaXJyb3IuUGFzcztcblx0fVxuXG5cdGZ1bmN0aW9uIGNvZGVNaXJyb3JJc0luaXRpYWxpemVkKCkge1xuXHRcdHJldHVybiAkKCcjc20tZmVlZC10ZW1wbGF0ZScpXG5cdFx0XHQubmV4dCgpXG5cdFx0XHQuaGFzQ2xhc3MoJ0NvZGVNaXJyb3InKTtcblx0fVxuXG5cdCRwcmV2aWV3Qm94ID0gJGRpYWxvZ0Rpdi5maW5kKCcjc20tZmVlZHMtcHJldmlldycpO1xuXHQkc291cmNlQm94ID0gJGRpYWxvZ0Rpdi5maW5kKCcjc20tZmVlZHMtcHJldmlldy1zb3VyY2UnKTtcblx0JGRhdGFCb3ggPSAkZGlhbG9nRGl2LmZpbmQoJyNzbS1mZWVkcy1kYXRhJyk7XG5cdCR0ZW1wbGF0ZSA9ICRkaWFsb2dEaXYuZmluZCgnI3NtLWZlZWQtdGVtcGxhdGUnKTtcblxuXHRpZiAoIWNvZGVNaXJyb3JJc0luaXRpYWxpemVkKCkpIHtcblx0XHRjb25zdCBjb2RlTWlycm9yID0gaW5pdENvZGVNaXJyb3IoJyNzbS1mZWVkLXRlbXBsYXRlJywge1xuXHRcdFx0bW9kZTogeyBuYW1lOiAndHdpZycsIGh0bWxNb2RlOiB0cnVlIH0sXG5cdFx0XHRhY3Rpb25CdG5zU2VsZWN0b3I6ICcuc20tZmVlZC10ZW1wbGF0ZS1idXR0b24nLFxuXHRcdFx0ZXh0cmFLZXlzOiB7XG5cdFx0XHRcdFwiJy4nXCI6IGNvbXBsZXRlQWZ0ZXJEb3QsXG5cdFx0XHRcdCdDdHJsLVNwYWNlJzogJ2F1dG9jb21wbGV0ZScsXG5cdFx0XHR9LFxuXHRcdH0pO1xuXG5cdFx0Y29kZU1pcnJvci5vbignYmx1cicsIGNtID0+IHtcblx0XHRcdGNvbnN0IGRhdGEgPSBjbS5nZXRWYWx1ZSgpLnRyaW0oKTtcblx0XHRcdHByZXZpZXdGZWVkKGRhdGEpO1xuXHRcdH0pO1xuXG5cdFx0bGV0IHNhbXBsZUtleSA9IDA7XG5cdFx0JGRpYWxvZ0Rpdi5vbignY2xpY2snLCAnI3NtLXRlbXBsYXRlLXNhbXBsZXMnLCBlID0+IHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGNvbnN0IHNhbXBsZSA9IHNhbXBsZXNbc2FtcGxlS2V5XS50cmltKCk7XG5cdFx0XHRzYW1wbGVLZXkgPSBzYW1wbGVLZXkgPCBzYW1wbGVzLmxlbmd0aCAtIDEgPyBzYW1wbGVLZXkgKyAxIDogMDtcblx0XHRcdGNvZGVNaXJyb3Iuc2V0VmFsdWUoc2FtcGxlKTtcblx0XHRcdHByZXZpZXdGZWVkKHNhbXBsZSk7XG5cdFx0fSk7XG5cdH1cblxuXHQkZGlhbG9nRGl2Lm9uKCdpbnB1dCcsICcuc20tbXVsdGktaW5wdXQtaXRlbSBpbnB1dCcsIGdldEZpZWxkcyk7XG5cdCRkaWFsb2dEaXYub24oJ2NsaWNrJywgJy5zbS1tdWx0aS1pbnB1dC1kZWxldGUnLCBnZXRGaWVsZHMpO1xuXHQkZGlhbG9nRGl2LmZpbmQoJyNzbS1mZWVkcy10YWJzJykudGFicyh7XG5cdFx0YWN0aXZlOiBmYWxzZSxcblx0XHRjb2xsYXBzaWJsZTogdHJ1ZSxcblx0fSk7XG5cblx0Z2V0RmllbGRzKCk7XG59XG4iLCIvLyBleHRyYWN0ZWQgYnkgbWluaS1jc3MtZXh0cmFjdC1wbHVnaW4iXSwic291cmNlUm9vdCI6IiJ9