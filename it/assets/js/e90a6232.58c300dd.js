(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[642],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=i.createContext({}),s=function(e){var t=i.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=s(e.components);return i.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=a,b=d["".concat(c,".").concat(m)]||d[m]||u[m]||o;return n?i.createElement(b,r(r({ref:t},p),{},{components:n})):i.createElement(b,r({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var s=2;s<o;s++)r[s]=n[s];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8934:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return s},toc:function(){return p},default:function(){return d}});var i=n(2122),a=n(9756),o=(n(7294),n(3905)),r=["components"],l={title:"Estendere phpBB SiteMaker",sidebar_position:1},c=void 0,s={unversionedId:"dev/overview",id:"dev/overview",isDocsHomePage:!1,title:"Estendere phpBB SiteMaker",description:"\xc8 possibile estendere / modificare phpBB SiteMaker utilizzando service replacement, service decoration, e phpBB event system. Puoi trovare una lista di eventi supportati qui.",source:"@site/i18n/it/docusaurus-plugin-content-docs/current/dev/overview.md",sourceDirName:"dev",slug:"/dev/overview",permalink:"/phpBB-ext-sitemaker/it/docs/dev/overview",editUrl:"https://crowdin.com/project/phpbb-ext-sitemaker/it",version:"current",sidebarPosition:1,frontMatter:{title:"Estendere phpBB SiteMaker",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Personalizzazione Visualizzazione Blocchi",permalink:"/phpBB-ext-sitemaker/it/docs/user/site/block-modifiers"},next:{title:"Eventi phpBB SiteMaker",permalink:"/phpBB-ext-sitemaker/it/docs/dev/events"}},p=[{value:"Creare un blocco SiteMaker",id:"creare-un-blocco-sitemaker",children:[{value:"Impostazioni Blocco",id:"impostazioni-blocco",children:[]},{value:"Blocchi Naming",id:"blocchi-naming",children:[]},{value:"Traduzione",id:"traduzione",children:[]},{value:"Rendering del blocco",id:"rendering-del-blocco",children:[]},{value:"Blocca Attivit\xe0",id:"blocca-attivit\xe0",children:[]}]}],u={toc:p};function d(e){var t=e.components,n=(0,a.Z)(e,r);return(0,o.kt)("wrapper",(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"\xc8 possibile estendere / modificare phpBB SiteMaker utilizzando ",(0,o.kt)("a",{parentName:"p",href:"https://area51.phpbb.com/docs/dev/3.2.x/extensions/tutorial_advanced.html#using-service-replacement"},"service replacement"),", ",(0,o.kt)("a",{parentName:"p",href:"https://area51.phpbb.com/docs/dev/3.2.x/extensions/tutorial_advanced.html#using-service-decoration"},"service decoration"),", e ",(0,o.kt)("a",{parentName:"p",href:"https://area51.phpbb.com/docs/dev/3.2.x/extensions/tutorial_events.html"},"phpBB event system"),". Puoi trovare una lista di eventi supportati ",(0,o.kt)("a",{parentName:"p",href:"/phpBB-ext-sitemaker/it/docs/dev/events"},"qui"),"."),(0,o.kt)("h2",{id:"creare-un-blocco-sitemaker"},"Creare un blocco SiteMaker"),(0,o.kt)("p",null,"Un blocco phpBB SiteMaker \xe8 semplicemente una classe che estende la classe blitze\\sitemaker\\services\\blocks\\driver\\block e restituisce un array dal metodo \"display\" con un 'title' e 'content'. Tutto il resto intra dipende da te. Per rendere il tuo blocco scopribile da phpBB SiteMaker, dovrai dargli il tag \"sitemaker.block\"."),(0,o.kt)("p",null,'Diciamo che abbiamo un\'estensione con vendor/extension come mio/esempio. Per creare un blocco chiamato "my_block" per phpBB SiteMaker:'),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'Crea una cartella "blocchi"'),(0,o.kt)("li",{parentName:"ul"},"Crea file my_block.php nella cartella dei blocchi con il seguente contenuto")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"namespace my\\example\\blocks;\n\nuse blitze\\sitemaker\\services\\blocks\\driver\\block;\n\nclass my_block extends block\n{\n    /**\n     * {@inheritdoc}\n     */\n    public function display(array $settings, $edit_mode = false)\n    {\n        return array(\n            'title' => 'my block title',\n            'contenuto' => 'contenuto del mio blocco',\n        );\n    }\n}\n")),(0,o.kt)("p",null,"Quindi nel tuo file config.yml, aggiungi quanto segue:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},"servizi:\n\n...\n\n    my.example.block.my_block:\n        class: my\\example\\blocks\\my_block\n        calls:\n            - [set_name, [my.example.block.my_block]]\n        tags:\n            - { name: sitemaker.block }\n\n....\n\n")),(0,o.kt)("p",null,"Al minimo nudo \xe8 tutto quello che ti serve. Se si entra in modalit\xe0 modifica, si dovrebbe vedere il blocco elencato come 'MY_EXAMPLE_BLOCK_MY_BLOCK' che pu\xf2 essere trascinato e lasciato cadere in qualsiasi posizione di blocco. Ma questo blocco non fa nulla di eccitante. Non ha impostazioni e non traduce il nome del blocco. La rendiamo pi\xf9 interessante."),(0,o.kt)("h3",{id:"impostazioni-blocco"},"Impostazioni Blocco"),(0,o.kt)("p",null,'Modifichiamo i nostri blocchi/mio_blocco. hp file e aggiungere un metodo "get_config" th a restituisce un array con le chiavi che sono le impostazioni del blocco e i valori che sono un array che descrive le impostazioni in questo modo:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"    /**\n     * @inheritdoc\n     */\n    public function get_config(array $settings)\n    {\n        $options = array(1 => 'SOME_LANG_VAR', 2 => 'OTHER_LANG_VAR');\n        return array(\n            'legend1' => 'TAB1',\n            'checkbox' => array('lang' => 'SOME_LANG_VAR_1', 'validate' => 'string', 'type' => 'checkbox', 'options' => $options, 'default' => array(), 'spiegare' => falso),\n            's\xec_no' => array('lang' => 'SOME_LANG_VAR_2', 'validate' => 'bool', 'type' => 'radio:yes_no', 'explain' => false, 'default' => false),\n            'radio' => array('lang' => 'SOME_LANG_VAR_3', 'validate' => 'bool', 'type' => 'radio', 'options' => $options, 'spiegare' => falso, 'default' => 'topic'),\n            'select' => array('lang' => 'SOME_LANG_VAR_4', 'validate' => 'string', 'type' => 'select', 'options' => $options, 'default' => '', 'spiegare' => falso),\n            'multi' => array('lang' => 'SOME_LANG_VAR_5', 'validate' => 'string', 'type' => 'multi_select', 'options' => $options, 'default' => array(), 'explain' => false),\n            'legend2' => 'TAB2',\n            'number' => array('lang' => 'SOME_LANG_VAR_6', 'validate' => 'int:0:20', 'type' => 'number:0:20', 'maxlength' => 2, 'explain' => false, 'default' => 5),\n            'textarea' => array('lang' => 'SOME_LANG_VAR_7', 'validate' => 'string', 'type' => 'textarea:3:40', 'maxlength' => 2, 'explain' => true, 'default' => ''),\n            'togglable' => array('lang' => 'SOME_TOGGLABLE_VAR', 'validate' => 'string', 'type' => 'select:1:0:toggle_key', 'options' => $options, 'default' => '', 'append' => '<div id=\"toggle_key-1\">Mostra solo quando \xe8 selezionata l'opzione 1</div>'),\n        );\n}\n")),(0,o.kt)("p",null,"Questo \xe8 costruito nello stesso modo in cui phpBB costruisce la configurazione per le impostazioni della scheda in ACP. Puoi vedere altri esempi ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/phpbb/phpbb/blob/master/phpBB/includes/acp/acp_board.php"},"qui"),"."),(0,o.kt)("p",null,"Se si desidera un tipo di campo personalizzato, si pu\xf2 vedere un esempio ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/blitze/phpBB-ext-sitemaker_content/blob/develop/blocks/recent.php"},"qui")," ('content_type' impostazione)."),(0,o.kt)("p",null,"Nota 'legend1' e 'legend2': questi sono usati per separare le impostazioni in schede."),(0,o.kt)("h3",{id:"blocchi-naming"},"Blocchi Naming"),(0,o.kt)("p",null,"La convenzione per i nomi dei blocchi \xe8 che il nome del servizio (ad esempio my.example.block. y",(0,o.kt)("em",{parentName:"p"},"block above) sar\xe0 usato come chiave della lingua sostituendo i punti (.) con underscore ("),") (e.g MY_EXAMPLE_BLOCK_MY_BLOCK)."),(0,o.kt)("h3",{id:"traduzione"},"Traduzione"),(0,o.kt)("p",null,'Notate anche che abbiamo diverse chiavi di lingua che devono essere tradotte. Per fare questo, creare un file chiamato "blocks_admin.php" nella cartella della lingua. Questo file verr\xe0 caricato automaticamente quando si modificano i blocchi, e dovrebbe avere traduzioni per le impostazioni dei blocchi e i nomi dei blocchi.'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$lang = array_merge($lang, array(\n    'SOME_LANG_VAR' => 'Opzione 1',\n    'OTHER_LANG_VAR' => 'Opzione 2',\n    'SOME_LANG_VAR_1' => 'Setting 1',\n....\n    'MY_EXAMPLE_BLOCK_MY_BLOCK' => 'My Block',\n);\n")),(0,o.kt)("p",null,"Poich\xe9 'blocks_admin.php' \xe8 caricato solo quando si modificano i blocchi, \xe8 necessario aggiungere altre traduzioni (ad es. titolo del blocco) caricando un file di lingua nel tuo metodo di visualizzazione come ",(0,o.kt)("inlineCode",{parentName:"p"},"$language->add_lang('my_lang_file', 'my/example');")),(0,o.kt)("h3",{id:"rendering-del-blocco"},"Rendering del blocco"),(0,o.kt)("p",null,"Il nuovo blocco verr\xe0 visualizzato solo se sta rendendo qualcosa. Il tuo blocco pu\xf2 restituire qualsiasi stringa come contenuto, ma nella maggior parte dei casi hai bisogno di un modello per rendere i tuoi contenuti. Per rendere il tuo blocco usando i modelli, il blocco deve restituire un array che contiene i dati che si desidera passare al modello e deve anche implementare il metodo ",(0,o.kt)("inlineCode",{parentName:"p"},"get_template")," come dimostrato di seguito:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"    /**\n     * @inheritdoc\n     */\n    public function get_config(array $settings)\n    {\n        $options = array(1 => 'SOME_LANG_VAR', 2 => 'OTHER_LANG_VAR');\n        return array(\n            'legend1' => 'TAB1',\n            'some_setting' => array('lang' => 'SOME_LANG_VAR_1', 'validate' => 'string', 'type' => 'checkbox', 'options' => $options, 'default' => array(), 'explain' => false),\n        );\n    }\n\n    /**\n     * {@inheritdoc}\n     */\n    public function get_template()\n    {\n        return '@my_example/my_block. tml';\n    }\n\n    /**\n     * {@inheritdoc}\n     */\n    public function display(array $data, $edit_mode = false)\n    {\n        if ($edit_mode)\n        {\n            // do something only in edit mode\n        }\n\n        return array(\n            'title' => 'MY_BLOCK_TITLE',\n            'data' => array(\n                'some_var' => $data['settings']['some_setting'],\n            ),\n        );\n}\n")),(0,o.kt)("p",null,"Quindi i tuoi styles/all/my_block.html o styles/prosilver/my_block.html file potrebbero assomigliare a questo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<p>Hai selezionato: {{ some_var }}</p>\n")),(0,o.kt)("p",null,"In sintesi, il tuo blocco deve restituire un array con una chiave ",(0,o.kt)("inlineCode",{parentName:"p"},"title")," (per il titolo del blocco) e una chiave ",(0,o.kt)("inlineCode",{parentName:"p"},"content")," (se il blocco visualizza solo una stringa e non utilizza un modello) o una chiave ",(0,o.kt)("inlineCode",{parentName:"p"},"dati")," (se il blocco utilizza un modello, in questo caso, dovrai anche implementare il metodo ",(0,o.kt)("inlineCode",{parentName:"p"},"get_template"),")."),(0,o.kt)("h3",{id:"blocca-attivit\xe0"},"Blocca Attivit\xe0"),(0,o.kt)("p",null,"Se il tuo blocco ha bisogno di aggiungere asset (css/js) alla pagina, ti consiglio di usare la sitemaker ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/blitze/phpBB-ext-sitemaker/blob/develop/services/util.php"},"util class")," per questo. Dal momento che ci pu\xf2 essere pi\xf9 di un'istanza dello stesso blocco sulla pagina, o altri blocchi potrebbero essere l'aggiunta della stessa attivit\xe0, la classe util assicura che l'asset \xe8 solo aggiunto."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"        $this->util->add_assets(array(\n            'js' => array(\n                '@my_example/assets/some. s',\n                100 => '@my_example/assets/other. s', // imposta priorit\xe0\n            ),\n            'css' => array(\n                '@my_example/assets/some. s',\n            )\n));\n")),(0,o.kt)("p",null,"La classe util dovr\xe0, ovviamente, essere aggiunta alle definizioni del servizio in config.yml cos\xec: ",(0,o.kt)("inlineCode",{parentName:"p"},"- '@blitze.sitemaker. til'")," e definito nel costruttore del blocco ",(0,o.kt)("inlineCode",{parentName:"p"},"\\blitze\\sitemaker\\services\\util $util"),"."),(0,o.kt)("p",null,"E questo \xe8 tutto. Abbiamo finito!"))}d.isMDXComponent=!0}}]);