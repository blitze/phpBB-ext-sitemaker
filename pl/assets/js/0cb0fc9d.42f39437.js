(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[499],{3905:function(e,a,t){"use strict";t.d(a,{Zo:function(){return c},kt:function(){return d}});var n=t(7294);function i(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){i(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function r(e,a){if(null==e)return{};var t,n,i=function(e,a){if(null==e)return{};var t,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||(i[t]=e[t]);return i}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=n.createContext({}),s=function(e){var a=n.useContext(p),t=a;return e&&(t="function"==typeof e?e(a):l(l({},a),e)),t},c=function(e){var a=s(e.components);return n.createElement(p.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},k=n.forwardRef((function(e,a){var t=e.components,i=e.mdxType,o=e.originalType,p=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),k=s(t),d=i,m=k["".concat(p,".").concat(d)]||k[d]||u[d]||o;return t?n.createElement(m,l(l({ref:a},c),{},{components:t})):n.createElement(m,l({ref:a},c))}));function d(e,a){var t=arguments,i=a&&a.mdxType;if("string"==typeof e||i){var o=t.length,l=new Array(o);l[0]=k;var r={};for(var p in a)hasOwnProperty.call(a,p)&&(r[p]=a[p]);r.originalType=e,r.mdxType="string"==typeof e?e:i,l[1]=r;for(var s=2;s<o;s++)l[s]=t[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}k.displayName="MDXCreateElement"},4453:function(e,a,t){"use strict";t.r(a),t.d(a,{frontMatter:function(){return r},contentTitle:function(){return p},metadata:function(){return s},toc:function(){return c},default:function(){return k}});var n=t(2122),i=t(9756),o=(t(7294),t(3905)),l=["components"],r={title:"Rozszerzanie phpBB SiteMaker",sidebar_position:1},p=void 0,s={unversionedId:"dev/overview",id:"dev/overview",isDocsHomePage:!1,title:"Rozszerzanie phpBB SiteMaker",description:"Mo\u017cesz rozszerzy\u0107/zmodyfikowa\u0107 phpBB SiteMaker u\u017cywaj\u0105c wymiany us\u0142ug, dekoracji us\u0142ugi systemu wydarze\u0144 phpBB. Tutaj znajdziesz list\u0119 obs\u0142ugiwanych wydarze\u0144 .",source:"@site/i18n/pl/docusaurus-plugin-content-docs/current/dev/overview.md",sourceDirName:"dev",slug:"/dev/overview",permalink:"/phpBB-ext-sitemaker/pl/docs/dev/overview",editUrl:"https://crowdin.com/project/phpbb-ext-sitemaker/pl",version:"current",sidebarPosition:1,frontMatter:{title:"Rozszerzanie phpBB SiteMaker",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Dostosowywanie wy\u015bwietlania blok\xf3w",permalink:"/phpBB-ext-sitemaker/pl/docs/user/site/block-modifiers"},next:{title:"Wydarzenia phpBB SiteMaker",permalink:"/phpBB-ext-sitemaker/pl/docs/dev/events"}},c=[{value:"Tworzenie bloku SiteMaker",id:"tworzenie-bloku-sitemaker",children:[{value:"Ustawienia bloku",id:"ustawienia-bloku",children:[]},{value:"Nazewnictwo blok\xf3w",id:"nazewnictwo-blok\xf3w",children:[]},{value:"T\u0142umaczenie",id:"t\u0142umaczenie",children:[]},{value:"Renderowanie bloku",id:"renderowanie-bloku",children:[]},{value:"Blokuj zasoby",id:"blokuj-zasoby",children:[]}]}],u={toc:c};function k(e){var a=e.components,t=(0,i.Z)(e,l);return(0,o.kt)("wrapper",(0,n.Z)({},u,t,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Mo\u017cesz rozszerzy\u0107/zmodyfikowa\u0107 phpBB SiteMaker u\u017cywaj\u0105c ",(0,o.kt)("a",{parentName:"p",href:"https://area51.phpbb.com/docs/dev/3.2.x/extensions/tutorial_advanced.html#using-service-replacement"},"wymiany us\u0142ug"),", ",(0,o.kt)("a",{parentName:"p",href:"https://area51.phpbb.com/docs/dev/3.2.x/extensions/tutorial_advanced.html#using-service-decoration"},"dekoracji us\u0142ug"),"i ",(0,o.kt)("a",{parentName:"p",href:"https://area51.phpbb.com/docs/dev/3.2.x/extensions/tutorial_events.html"},"systemu wydarze\u0144 phpBB"),". Tutaj znajdziesz list\u0119 obs\u0142ugiwanych wydarze\u0144 ",(0,o.kt)("a",{parentName:"p",href:"/phpBB-ext-sitemaker/pl/docs/dev/events"}),"."),(0,o.kt)("h2",{id:"tworzenie-bloku-sitemaker"},"Tworzenie bloku SiteMaker"),(0,o.kt)("p",null,"Blok phpBB SiteMaker jest po prostu klas\u0105, kt\xf3ra rozszerza blitze\\sitemaker\\services\\blocks\\driver\\block class i zwraca tablic\u0119 z metody \"display\" z 'title' i 'content'. Wszystko inne mi\u0119dzy sob\u0105 nale\u017cy do Ciebie. Aby tw\xf3j blok m\xf3g\u0142 zosta\u0107 odkryty przez phpBB SiteMaker, musisz nada\u0107 mu znacznik \"sitemaker.block\"."),(0,o.kt)("p",null,'Powiedz nam, \u017ce mamy rozszerzenie z vendor/extension jako moje/przyk\u0142ad. Aby utworzy\u0107 blok o nazwie "my_block" dla phpBB SiteMaker:'),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'Utw\xf3rz folder "blocks"'),(0,o.kt)("li",{parentName:"ul"},"Utw\xf3rz plik my_block.php w folderze blok\xf3w z nast\u0119puj\u0105c\u0105 zawarto\u015bci\u0105")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"przestrze\u0144 nazw my\\example\\blocks;\n\nu\u017cyj blitze\\sitemaker\\services\\blocks\\driver\\block;\n\nclass my_block extends block\n{\n    /**\n     * {@inheritdoc}\n     */\n    public function display(tablica $settings, $edit_mode = false)\n    {\n        zwraca tablic\u0119 (\n            'title' => 'm\xf3j tytu\u0142 bloku',\n            'content' => 'moja zawarto\u015b\u0107 bloku',\n        );\n    }\n}\n")),(0,o.kt)("p",null,"Nast\u0119pnie w pliku config.yml dodaj nast\u0119puj\u0105ce dane:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},"us\u0142ugi:\n\n...\n\n    my.example.block.my_block:\n        klasa: my\\example\\blocks\\my_block\n        wywo\u0142ania:\n            - [set_name, [my.example.block.my_block]]\n        tagi:\n            - { name: sitemaker.block }\n\n....\n\n")),(0,o.kt)("p",null,"Na pustym minimum, to wszystko, czego potrzebujesz. Je\u015bli przejdziesz do trybu edycji, powiniene\u015b zobaczy\u0107 blok wymieniony jako 'MY_EXAMPLE_BLOCK_MY_BLOCK', kt\xf3ry mo\u017ce by\u0107 ci\u0105gni\u0119ty i upuszczony na dowolnej pozycji bloku. Ale ten blok nie robi nic ekscytuj\u0105cego. Nie ma \u017cadnych ustawie\u0144 i nie t\u0142umaczy nazwy bloku. Zr\xf3bmy to bardziej interesuj\u0105co."),(0,o.kt)("h3",{id:"ustawienia-bloku"},"Ustawienia bloku"),(0,o.kt)("p",null,'Zmodyfikuj nasze bloki/my_block. plik hp i dodaj metod\u0119 "get_config" zwracaj\u0105c tablic\u0119 z kluczami b\u0119d\u0105cymi ustawieniami bloku, a warto\u015bciami b\u0119d\u0105cymi tablic\u0105 opisuj\u0105c\u0105 ustawienia takie jak tak:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"    /**\n     * @inheritdoc\n     */\n    funkcja publiczna get_config(tablica $settings)\n    {\n        $options = array(1 => 'SOME_LANG_VAR', 2 => 'OTHER_LANG_VAR');\n        zwr\xf3\u0107 tablic\u0119 (\n            'legend1' => 'TAB1',\n            'pole wyboru' => array('lang' => 'SOME_LANG_VAR_1', 'validate' => 'string', 'type' => 'checkbox', 'options' => $options, 'default' => array(), 'explain' => false),\n            'yes_no' => array('lang' => 'SOME_LANG_VAR_2', 'validate' => 'bool', 'type' => 'radio:yes_no', 'explain' => false, 'default' => false),\n            'radio' => array('lang' => 'SOME_LANG_VAR_3', 'validate' => 'bool', 'type' => 'radio', 'options' => $options, 'explain' => false, 'default' => 'temat'),\n            'select' => array('lang' => 'SOME_LANG_VAR_4', 'validate' => 'string', 'type' => 'select', 'options' => $options, 'default' => '', 'explain' => false),\n            'multi' => tablica ('lang' => 'SOME_LANG_VAR_5', 'validate' => 'string', 'type' => 'multi_select', 'options' => $options, 'default' => array(), 'explain' => false),\n            'legend2' => 'TAB2',\n            'number' => array('lang' => 'SOME_LANG_VAR_6', 'validate' => 'int:0:20', 'type' => 'number:0:20', 'maxlength' => 2, 'explain' => false, 'default' => 5),\n            'textarea' => array('lang' => 'SOME_LANG_VAR_7', 'validate' => 'string', 'type' => 'textarea:3:40', 'maxlength' => 2, 'explain' => true, 'default' => ''),\n            'w\u0142\u0105czalny' => tablica ('lang' => 'SOME_TOGGLABLE_VAR', 'validate' => 'string', 'type' => 'select:1:0:toggle_key', 'options' => $options'default' => '', 'append' => '<div id=\"toggle_key-1\">Poka\u017c tylko, gdy wybrano opcj\u0119 1</div>'),\n        );\n}\n")),(0,o.kt)("p",null,"Jest to zbudowane w taki sam spos\xf3b, jak phpBB buduje konfiguracj\u0119 ustawie\u0144 p\u0142yt w ACP. Mo\u017cesz zobaczy\u0107 wi\u0119cej przyk\u0142ad\xf3w ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/phpbb/phpbb/blob/master/phpBB/includes/acp/acp_board.php"},"tutaj"),"."),(0,o.kt)("p",null,"Je\u015bli chcesz typ pola niestandardowego, mo\u017cesz zobaczy\u0107 przyk\u0142ad ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/blitze/phpBB-ext-sitemaker_content/blob/develop/blocks/recent.php"},"tutaj")," (ustawienie 'content_type')."),(0,o.kt)("p",null,"Zg\u0142o\u015b 'legenda1' i 'legend2': S\u0105 one u\u017cywane do oddzielania ustawie\u0144 na karty."),(0,o.kt)("h3",{id:"nazewnictwo-blok\xf3w"},"Nazewnictwo blok\xf3w"),(0,o.kt)("p",null,"Konwencja dla nazw blok\xf3w jest taka, \u017ce nazwa us\u0142ugi (np. my.example.block. y",(0,o.kt)("em",{parentName:"p"},"blok powy\u017cej) b\u0119dzie u\u017cywany jako klucz j\u0119zykowy, zast\u0119puj\u0105c kropki (.) podkre\u015bleniem ("),") (np. MY_EXAMPLE_BLOCK_MY_BLOCK)."),(0,o.kt)("h3",{id:"t\u0142umaczenie"},"T\u0142umaczenie"),(0,o.kt)("p",null,'Zauwa\u017c, \u017ce mamy kilka kluczy j\u0119zykowych, kt\xf3re trzeba przet\u0142umaczy\u0107. Aby to zrobi\u0107, utw\xf3rz plik o nazwie "blocks_admin.php" w folderze j\u0119zykowym. Ten plik zostanie automatycznie za\u0142adowany podczas edycji blok\xf3w i powinien mie\u0107 t\u0142umaczenia dla ustawie\u0144 blok\xf3w i nazw blok\xf3w.'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$lang = array_merge($lang, tablica(\n    'SOME_LANG_VAR' => 'Opcja 1',\n    'OTHER_LANG_VAR' => 'Wariant 2',\n    'SOME_LANG_VAR_1' => 'Ustawienie 1',\n....\n    'MY_EXAMPLE_BLOCK_MY_BLOCK' => 'M\xf3j blok',\n);\n")),(0,o.kt)("p",null,"Poniewa\u017c 'blocks_admin.php' jest \u0142adowany tylko podczas edycji blok\xf3w, musisz doda\u0107 inne t\u0142umaczenia (np. blokuj tytu\u0142) wczytywaj\u0105c plik j\u0119zykowy w metodzie wy\u015bwietlania, tak jak ",(0,o.kt)("inlineCode",{parentName:"p"},"$language->add_lang('my_lang_file', 'my/example');")),(0,o.kt)("h3",{id:"renderowanie-bloku"},"Renderowanie bloku"),(0,o.kt)("p",null,"Nowy blok b\u0119dzie wy\u015bwietlany tylko wtedy, gdy co\u015b renderowuje. Tw\xf3j blok mo\u017ce zwr\xf3ci\u0107 dowolny ci\u0105g znak\xf3w jako tre\u015b\u0107, ale w wi\u0119kszo\u015bci przypadk\xf3w potrzebujesz szablonu, aby renderowa\u0107 zawarto\u015b\u0107. Aby wyrenderowa\u0107 sw\xf3j blok za pomoc\u0105 szablon\xf3w, blok musi zwraca\u0107 tablic\u0119 zawieraj\u0105c\u0105 dane, kt\xf3re chcesz przekaza\u0107 do szablonu i musi r\xf3wnie\u017c zaimplementowa\u0107 metod\u0119 ",(0,o.kt)("inlineCode",{parentName:"p"},"get_template")," , jak pokazano poni\u017cej:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"    /**\n     * @inheritdoc\n     */\n    funkcja publiczna get_config(tablica $settings)\n    {\n        $options = array(1 => 'SOME_LANG_VAR', 2 => 'OTHER_LANG_VAR');\n        zwr\xf3\u0107 tablic\u0119 (\n            'legend1' => 'TAB1',\n            'some_setting' => array('lang' => 'SOME_LANG_VAR_1', 'validate' => 'string', 'type' => 'checkbox', 'options' => $options, 'default' => array(), 'explain' => false),\n        );\n    }\n\n    /**\n     * {@inheritdoc}\n     */\n    public function get_template()\n    {\n        return '@my_example/my_block. tml';\n    }\n\n    /**\n     * {@inheritdoc}\n     */\n    wy\u015bwietlacz funkcji publicznych (tablica $data, $edit_mode = false)\n    {\n        if ($edit_mode)\n        {\n            // zr\xf3b co\u015b tylko w trybie edycji\n        }\n\n        zwraca tablic\u0119 (\n            'title' => 'MY_BLOCK_TITLE',\n            'data' => tablica (\n                'some_var' => $data['settings']['some_setting'],\n            ),\n        );\n}\n")),(0,o.kt)("p",null,"Nast\u0119pnie plik styles/all/my_block.html lub styles/prosilver/my_block.html mo\u017ce wygl\u0105da\u0107 tak:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<p>Wybra\u0142e\u015b: {{ some_var }}</p>\n")),(0,o.kt)("p",null,"Podsumowuj\u0105c, tw\xf3j blok musi zwraca\u0107 tablic\u0119 z kluczem ",(0,o.kt)("inlineCode",{parentName:"p"},"tytu\u0142")," (dla tytu\u0142u bloku) i kluczem ",(0,o.kt)("inlineCode",{parentName:"p"},"tre\u015bci")," (je\u015bli blok wy\u015bwietla tylko ci\u0105g znak\xf3w i nie u\u017cywa szablonu) lub kluczem ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," (je\u015bli blok u\u017cywa szablonu, W takim przypadku musisz r\xf3wnie\u017c wdro\u017cy\u0107 metod\u0119 ",(0,o.kt)("inlineCode",{parentName:"p"},"get_template"),"."),(0,o.kt)("h3",{id:"blokuj-zasoby"},"Blokuj zasoby"),(0,o.kt)("p",null,"Je\u015bli tw\xf3j blok musi doda\u0107 aktywa (css/js) do strony, zalecam u\u017cycie do tego narz\u0119dzia ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/blitze/phpBB-ext-sitemaker/blob/develop/services/util.php"},"util class"),". Poniewa\u017c na stronie mo\u017ce by\u0107 wi\u0119cej ni\u017c jedna instancja tego samego bloku, lub inne bloki mog\u0105 dodawa\u0107 ten sam sk\u0142adnik aktyw\xf3w, klasa util zapewnia, \u017ce sk\u0142adnik jest dodany tylko do niego."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"        $this->util->add_assets(array(\n            'js' => array(\n                '@my_example/assets/some. s',\n                100 => '@my_example/assets/other. s', // ustaw priorytet\n            ),\n            'css' => tablica(\n                '@my_example/assets/some. ss',\n            )\n));\n")),(0,o.kt)("p",null,"Klasa util b\u0119dzie oczywi\u015bcie musia\u0142a zosta\u0107 dodana do definicji us\u0142ug w pliku config.yml jak tak: ",(0,o.kt)("inlineCode",{parentName:"p"},"- '@blitze.sitemaker. do")," i zdefiniowane w konstruktorze twojego bloku ",(0,o.kt)("inlineCode",{parentName:"p"},"\\blitze\\sitemaker\\services\\util $util"),"."),(0,o.kt)("p",null,"I tak jest. Uda\u0142o si\u0119!"))}k.isMDXComponent=!0}}]);